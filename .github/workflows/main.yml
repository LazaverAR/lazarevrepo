name: Build and Test Python To-Do Docker App

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  build-and-test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Build Docker image
        run: docker build -t todo-python-app .

      - name: Run container and test app start
        run: |
          # Run container in detached mode
          docker run -d --name todo-test todo-python-app
          # Wait a few seconds to let the app start
          sleep 5
          # Check if container is still running
          docker ps | grep todo-test
          # Stop and remove container
          docker stop todo-test
          docker rm todo-test
